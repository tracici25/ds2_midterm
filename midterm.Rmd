---
title: "DS2 Midterm"
author: "Mufeng Xu"
date: "3/28/2021"
output: html_document
---

```{r}
library(tidyverse)
library(ISLR)
library(caret)
library(glmnet)
library(MASS)
library(e1071)
library(mlbench)
library(pROC)
library(AppliedPredictiveModeling)
```

```{r}
# Load and tidy
stroke = read_csv("healthcare-dataset-stroke-data.csv") %>% 
  dplyr::select(gender:stroke) %>% 
  filter(!bmi == "N/A") %>% 
  na.omit() %>% 
  janitor::clean_names() %>% 
  mutate(
    gender = case_when(gender == "Male" ~ "0",
                       gender == "Female" ~ "1",
                       gender == "Other" ~ "2"),
    ever_married = case_when(ever_married == "Yes" ~ "1",
                             ever_married == "No" ~ "0"),
    work_type = case_when(work_type == "children" ~ "0",
                          work_type == "Govt_jov" ~ "1",
                          work_type == "Never_worked" ~ "2",
                          work_type == "Private" ~ "3",
                          work_type == "Self-employed" ~ "4"),
    residence_type = case_when(residence_type == "Rural" ~ "0",
                               residence_type == "Urban" ~ "1"),
    smoking_status = case_when(smoking_status == "formerly smoked" ~ "0",
                               smoking_status == "never smoked" ~ "1",
                               smoking_status == "smokes" ~ "2",
                               smoking_status == "Unknown" ~ "3")
  )

summary(stroke)
```

```{r}
transparentTheme(trans = .4)
featurePlot(x = stroke[, 1:10], 
            y = stroke$stroke,
            scales = list(x = list(relation = "free"), 
                          y = list(relation = "free")),
            plot = "density", pch = "|", 
            auto.key = list(columns = 2))

```





